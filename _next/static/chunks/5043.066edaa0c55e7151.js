"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5043],{5043:function(n,e,r){r.r(e),r.d(e,{default:function(){return G}});var t,o,i,c,a,s=r(70865),l=r(87394),u=r(92228),d=r(52322),h=r(16816),f=r(73921),b=r(3411),p=r(80751),g=r(33080),x=r(5406),k=r(96914),v=r(32301),m=r(63093),Z=r(38497),N=r(98788),B=r(45680),j=r(2784),y=r(6647),w=r(72305),I=r(80173),S=r(11885);function O(){var n=(0,u.Z)(['\n            query getNftMarketSubgraphHealth {\n              indexingStatusForCurrentVersion(subgraphName: "','") {\n                health\n                chains {\n                  chainHeadBlock {\n                    number\n                  }\n                  latestBlock {\n                    number\n                  }\n                }\n              }\n            }\n          ']);return O=function(){return n},n}(t=o||(o={}))[t.OK=0]="OK",t[t.WARNING=1]="WARNING",t[t.NOT_OK=2]="NOT_OK",t[t.UNKNOWN=3]="UNKNOWN";var P=function(n){var e=(0,l.Z)((0,j.useState)({status:o.UNKNOWN,currentBlock:0,chainHeadBlock:0,latestBlock:0,blockDifference:0}),2),r=e[0],t=e[1];return(0,S.X)(function(e){var r;(r=(0,N.Z)(function(){var r,i,c,a,s,u,d,h,f;return(0,B.__generator)(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,Promise.all([(0,y.request)(I.AM,(0,y.gql)(O(),n)),e?Promise.resolve(e):w.v.getBlockNumber()])];case 1:return i=(r=l.Z.apply(void 0,[b.sent(),2]))[0].indexingStatusForCurrentVersion,c=r[1],a="healthy"===i.health,s=parseInt(i.chains[0].chainHeadBlock.number),d=c-(u=parseInt(i.chains[0].latestBlock.number)),h=c-s,!a||d>200||h>200?t({status:o.NOT_OK,currentBlock:c,chainHeadBlock:s,latestBlock:u,blockDifference:d}):d>50||h>50?t({status:o.WARNING,currentBlock:c,chainHeadBlock:s,latestBlock:u,blockDifference:d}):t({status:o.OK,currentBlock:c,chainHeadBlock:s,latestBlock:u,blockDifference:d}),[3,3];case 2:return f=b.sent(),console.error("Failed to perform health check for ".concat(n," subgraph"),f),[3,3];case 3:return[2]}})}),function(){return r.apply(this,arguments)})()},[n]),r};function C(){var n=(0,u.Z)(["\n  border-radius: 8px;\n  > div {\n    border-radius: 8px;\n  }\n  user-select: none;\n"]);return C=function(){return n},n}function D(){var n=(0,u.Z)(["\n  gap: 7px;\n"]);return D=function(){return n},n}function K(){var n=(0,u.Z)(["\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  background: ",";\n"]);return K=function(){return n},n}var _=(0,b.ZP)(p.Z).withConfig({componentId:"sc-46961c6e-0"})(C()),R=(0,b.ZP)(g.Z).withConfig({componentId:"sc-46961c6e-1"})(D()),W=(0,b.ZP)(x.ZP).withConfig({componentId:"sc-46961c6e-2"})(K(),function(n){var e=n.$color;return n.theme.colors[e]}),A=function(n){var e=n.color,r=n.label,t=n.description,o=n.currentBlock,i=n.secondRemainingBlockSync,c=n.blockNumberFromSubgraph,a=(0,f.$G)().t;return(0,d.jsxs)(x.ZP,{children:[(0,d.jsxs)(R,{pb:"10px",children:[(0,d.jsx)(W,{$color:e}),(0,d.jsx)(v.Z,{children:r})]}),(0,d.jsx)(v.Z,{pb:"24px",children:t}),(0,d.jsxs)(v.Z,{children:[(0,d.jsxs)("strong",{children:[a("Chain Head Block"),":"]})," ",o]}),(0,d.jsxs)(v.Z,{children:[(0,d.jsxs)("strong",{children:[a("Latest Subgraph Block"),":"]})," ",c]}),(0,d.jsxs)(v.Z,{children:[(0,d.jsxs)("strong",{children:[a("Delay"),":"]})," ",o-c," (",i,"s)"]})]})},G=function(n){var e=n.subgraphName,r=n.inline,t=n.customDescriptions,u=n.obeyGlobalSetting,b=(0,f.$G)().t,p=P(e),g=p.status,N=p.currentBlock,B=p.blockDifference,j=p.latestBlock,y=(0,l.Z)((0,Z.YF)(),1)[0],w=g===o.WARNING||g===o.NOT_OK,I={delayed:{label:b("Delayed"),color:"failure",description:null!==(i=null==t?void 0:t.delayed)&&void 0!==i?i:b("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},slow:{label:b("Slight delay"),color:"warning",description:null!==(c=null==t?void 0:t.slow)&&void 0!==c?c:b("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},healthy:{label:b("Fast"),color:"success",description:null!==(a=null==t?void 0:t.healthy)&&void 0!==a?a:b("No issues with the subgraph.")}},S=B*h.hJ,O=I[g===o.NOT_OK?"delayed":g===o.WARNING?"slow":"healthy"],C=(0,k.Z)((0,d.jsx)(A,(0,s.Z)({currentBlock:N,secondRemainingBlockSync:S,blockNumberFromSubgraph:j},O)),{placement:"top"}),D=C.targetRef,K=C.tooltipVisible,G=C.tooltip;return j&&N&&((void 0===u||u)&&y||w)?r?(0,d.jsxs)(R,{alignItems:"center",justifyContent:"flex-end",ref:D,children:[(0,d.jsx)(W,{$color:O.color}),(0,d.jsx)(v.Z,{children:O.label}),(0,d.jsx)(m.Z,{}),K&&G]}):(0,d.jsxs)(x.ZP,{position:"fixed",bottom:"calc(55px + env(safe-area-inset-bottom))",right:"5%",ref:D,"data-test":"subgraph-health-indicator",children:[K&&G,(0,d.jsx)(_,{children:(0,d.jsxs)(R,{alignItems:"center",p:"10px",children:[(0,d.jsx)(W,{$color:O.color}),(0,d.jsx)(v.Z,{children:O.label}),(0,d.jsx)(m.Z,{})]})})]}):null}},11885:function(n,e,r){r.d(e,{X:function(){return u},a:function(){return l}});var t=r(50930),o=r(57535),i=r(2784),c=r(3255),a=r(15112),s=[];function l(n,e){var r=(0,a.g)().chainId,l=(0,c.ZP)(r&&[o.sR,"blockNumber",r]).data,u=void 0===l?0:l;(0,i.useEffect)(n.bind(null,u),[u].concat((0,t.Z)(e||s)))}function u(n,e){var r=(0,a.g)().chainId,l=(0,c.ZP)(r&&[o.KI,"blockNumber",r]).data,u=void 0===l?0:l;(0,i.useEffect)(n.bind(null,u),[u].concat((0,t.Z)(e||s)))}},80751:function(n,e,r){r.d(e,{Z:function(){return x}});var t=r(70865),o=r(96670),i=r(26297),c=r(52322);r(2784);var a=r(92228),s=r(3411),l=r(78545),u=r(26074),d=r(5406);function h(){var n=(0,a.Z)(["\n      animation: "," 3s ease infinite;\n      background-size: 400% 400%;\n    "]);return h=function(){return n},n}function f(){var n=(0,a.Z)(["  \n  border-radius: ",";\n  color: ",";\n  overflow: hidden;\n  position: relative;\n\n  ","\n\n  padding: 1px 1px 3px 1px;\n\n  ","\n"]);return f=function(){return n},n}function b(){var n=(0,a.Z)(["\n  width: 100%;\n  height: 100%;\n  overflow: ",";\n  background: ",";\n  border-radius: 0.5rem;\n  // box-shadow: 0 20px 25px -5px #000,0 8px 10px -6px #000;\n"]);return b=function(){return n},n}var p=s.ZP.div.withConfig({componentId:"sc-48a4a64d-0"})(f(),function(n){return n.theme.radii.card},function(n){var e=n.theme,r=n.isDisabled;return e.colors[r?"textDisabled":"text"]},function(n){return n.isActive&&(0,s.iv)(h(),u.DS)},l.Dh),g=(0,s.ZP)(d.ZP).withConfig({componentId:"sc-48a4a64d-1"})(b(),function(n){return n.hasCustomBorder?"initial":"inherit"},function(n){var e=n.theme,r=n.background;return null!=r?r:e.card.background});p.defaultProps={isActive:!1,isSuccess:!1,isWarning:!1,isDisabled:!1};var x=function(n){var e=n.ribbon,r=n.children,a=(n.background,(0,i.Z)(n,["ribbon","children","background"]));return(0,c.jsx)(p,(0,o.Z)((0,t.Z)({},a),{children:(0,c.jsxs)(g,{background:"hsla(0,0%,100%,.15)",hasCustomBorder:!!a.borderBackground,children:[e,r]})}))}}}]);
//# sourceMappingURL=5043.066edaa0c55e7151.js.map